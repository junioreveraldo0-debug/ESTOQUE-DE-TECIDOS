(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[361],{9548:function(e,a,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/usuarios",function(){return s(6615)}])},5660:function(e,a,s){"use strict";s.d(a,{Z:function(){return d}});var r=s(5893),t=s(1664),n=s.n(t),l=s(1163),i=s(9732);function d(){let e=(0,l.useRouter)(),{user:a,logout:s}=(0,i.aC)();if(!a)return null;let t=[{href:"/dashboard",label:"Dashboard"},{href:"/articles",label:"Artigos"},{href:"/entrada",label:"Entrada"},{href:"/saida",label:"Sa\xedda"},{href:"/estoque",label:"Estoque"},{href:"/contagem",label:"Contagem"},{href:"/usuarios",label:"Usu\xe1rios"}];return(0,r.jsxs)("header",{className:"header sticky top-0 z-40 shadow-sm",children:[(0,r.jsxs)("div",{className:"max-w-5xl mx-auto flex items-center justify-between p-3",children:[(0,r.jsx)("div",{className:"flex items-center gap-4",children:(0,r.jsx)("img",{src:"/srj-logo.svg",alt:"SRJ",width:"140"})}),(0,r.jsx)("nav",{className:"hidden md:flex gap-2",children:t.map(a=>{let s=e.pathname===a.href;return(0,r.jsx)(n(),{href:a.href,children:(0,r.jsx)("div",{className:"nav-tab ".concat(s?"nav-tab-active":""),children:a.label})},a.href)})}),(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsxs)("div",{className:"text-sm text-gray-600",children:["Ol\xe1, ",null==a?void 0:a.username]}),(0,r.jsx)("button",{onClick:()=>{s()},className:"bg-brand-500 text-white px-3 py-1 rounded no-print",children:"Sair"})]})]}),(0,r.jsx)("div",{className:"md:hidden overflow-auto",children:(0,r.jsx)("div",{className:"flex gap-2 px-3 pb-2",children:t.map(e=>(0,r.jsx)(n(),{href:e.href,children:(0,r.jsx)("div",{className:"nav-tab",children:e.label})},e.href))})})]})}},6615:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return u}});var r=s(5893),t=s(6976),n=s(7294),l=s(5660);let i=e=>fetch(e).then(e=>e.json());function d(){try{let e=localStorage.getItem("estoque_srj_user");if(!e)return null;return JSON.parse(e).token}catch(e){return null}}function u(){let{data:e,mutate:a}=(0,t.ZP)("/api/users",i),[s,u]=(0,n.useState)(""),[c,o]=(0,n.useState)(""),[h,m]=(0,n.useState)(""),[x,f]=(0,n.useState)("usuario"),[p,j]=(0,n.useState)(null);(0,n.useEffect)(()=>{(async()=>{let e=await fetch("/api/users/me",{headers:{Authorization:"Bearer "+d()}});e.ok&&j((await e.json()).role)})()},[]);let b=async()=>{await fetch("/api/users",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:s,name:c,password:h,role:x})}),u(""),o(""),m(""),f("usuario"),a()},v=async e=>{if(!confirm("Excluir usu\xe1rio?"))return;let s=d();if(!s)return alert("Sem permiss\xe3o");let r=await fetch("/api/users/"+encodeURIComponent(e),{method:"DELETE",headers:{Authorization:"Bearer "+s}});r.ok?a():alert("Erro: "+await r.text())};return(0,r.jsxs)("div",{className:"min-h-screen",children:[(0,r.jsx)(l.Z,{}),(0,r.jsxs)("main",{className:"max-w-5xl mx-auto p-4",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-brand-500",children:"Usu\xe1rios"}),(0,r.jsxs)("div",{className:"mt-4 p-4 bg-white rounded shadow",children:[(0,r.jsx)("input",{value:s,onChange:e=>u(e.target.value),placeholder:"Login",className:"w-full border p-2 rounded mb-2"}),(0,r.jsx)("input",{value:c,onChange:e=>o(e.target.value),placeholder:"Nome",className:"w-full border p-2 rounded mb-2"}),(0,r.jsx)("input",{value:h,onChange:e=>m(e.target.value),placeholder:"Senha",className:"w-full border p-2 rounded mb-2"}),(0,r.jsxs)("select",{value:x,onChange:e=>f(e.target.value),className:"w-full border p-2 rounded mb-2",children:[(0,r.jsx)("option",{value:"usuario",children:"Usu\xe1rio"}),(0,r.jsx)("option",{value:"admin",children:"Admin"})]}),(0,r.jsx)("button",{onClick:b,className:"bg-brand-500 text-white rounded p-2",children:"Adicionar Usu\xe1rio"})]}),(0,r.jsx)("div",{className:"mt-4 bg-white p-4 rounded shadow",children:null==e?void 0:e.map(e=>(0,r.jsxs)("div",{className:"p-2 border-b flex justify-between items-center",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"font-medium",children:[e.name," ",(0,r.jsxs)("span",{className:"text-xs text-gray-400",children:["(",e.username,")"]})]}),(0,r.jsxs)("div",{className:"text-sm text-gray-500",children:["Perfil: ",e.role]})]}),(0,r.jsxs)("div",{className:"text-sm flex items-center gap-2",children:["admin"===p&&"admin"!==e.username&&(0,r.jsx)("button",{onClick:()=>v(e.username),className:"text-red-600",children:"Excluir"}),(0,r.jsx)("div",{className:"text-xs text-gray-400",children:e.username})]})]},e.username))})]})]})}}},function(e){e.O(0,[664,976,888,774,179],function(){return e(e.s=9548)}),_N_E=e.O()}]);